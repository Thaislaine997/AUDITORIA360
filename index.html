<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AUDITORIA360 - Portal de Gest√£o da Folha</title>
    <meta
      name="description"
      content="Portal seguro, inteligente e integrado para centralizar, automatizar e auditar todos os processos de folha de pagamento"
    />

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="./assets/logo.png" />

    <!-- Estilos -->
    <link rel="stylesheet" href="./assets/style.css" />
    
    <!-- Navigation Logger -->
    <script src="./frontend/src/utils/navigationLogger.js"></script>

    <style>
      /* Estilos espec√≠ficos para a p√°gina inicial */
      .login-container {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(
          135deg,
          var(--background-color) 0%,
          var(--secondary-background-color) 100%
        );
        position: relative;
        overflow: hidden;
      }

      .login-container::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background:
          radial-gradient(
            circle at 30% 20%,
            rgba(0, 212, 255, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 70% 80%,
            rgba(14, 165, 233, 0.1) 0%,
            transparent 50%
          );
        pointer-events: none;
      }

      .login-card {
        width: 100%;
        max-width: 400px;
        margin: var(--spacing-md);
        position: relative;
        z-index: 1;
      }

      .logo-container {
        text-align: center;
        margin-bottom: var(--spacing-xl);
      }

      .logo-container img {
        height: 80px;
        width: auto;
        margin-bottom: var(--spacing-md);
        filter: drop-shadow(0 0 20px rgba(0, 212, 255, 0.5));
      }

      .logo-title {
        font-size: var(--font-size-3xl);
        font-weight: 700;
        color: var(--primary-color);
        margin: 0;
        text-shadow: 0 0 30px rgba(0, 212, 255, 0.4);
      }

      .logo-subtitle {
        font-size: var(--font-size-sm);
        color: var(--secondary-text-color);
        margin-top: var(--spacing-xs);
      }

      .login-form {
        background: var(--glass-background);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: var(--border-radius-xl);
        padding: var(--spacing-xl);
        box-shadow: var(--shadow-lg);
      }

      .form-title {
        text-align: center;
        margin-bottom: var(--spacing-xl);
        color: var(--text-color);
        font-size: var(--font-size-xl);
        font-weight: 600;
      }

      .user-type-selector {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-lg);
      }

      .user-type-btn {
        padding: var(--spacing-md);
        border: 2px solid var(--border-color);
        border-radius: var(--border-radius-md);
        background: transparent;
        color: var(--secondary-text-color);
        cursor: pointer;
        transition: all var(--transition-normal);
        text-align: center;
        font-weight: 500;
      }

      .user-type-btn.active {
        border-color: var(--primary-color);
        background: rgba(0, 212, 255, 0.1);
        color: var(--primary-color);
        box-shadow: 0 0 15px rgba(0, 212, 255, 0.3);
      }

      .user-type-btn:hover {
        border-color: var(--primary-color);
        color: var(--primary-color);
      }

      .dashboard-container {
        min-height: 100vh;
        background: var(--background-color);
        display: none;
      }

      .dashboard-container.active {
        display: block;
      }

      .header-bar {
        background: var(--secondary-background-color);
        border-bottom: 1px solid var(--border-color);
        padding: var(--spacing-md) var(--spacing-lg);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .header-info {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
      }

      .header-logo {
        height: 40px;
        width: auto;
      }

      .user-info {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        color: var(--text-color);
      }

      .logout-btn {
        background: var(--danger-color);
        color: white;
        border: none;
        padding: var(--spacing-sm) var(--spacing-md);
        border-radius: var(--border-radius-md);
        cursor: pointer;
        font-size: var(--font-size-sm);
        transition: all var(--transition-fast);
      }

      .logout-btn:hover {
        background: #dc2626;
        transform: translateY(-1px);
      }

      .main-content {
        display: grid;
        grid-template-columns: 250px 1fr;
        min-height: calc(100vh - 73px);
      }

      .sidebar {
        background: var(--secondary-background-color);
        border-right: 1px solid var(--border-color);
        padding: var(--spacing-lg);
      }

      .sidebar-title {
        color: var(--primary-color);
        font-weight: 600;
        margin-bottom: var(--spacing-lg);
        padding-bottom: var(--spacing-sm);
        border-bottom: 1px solid var(--border-color);
      }

      .nav-menu {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .nav-menu li {
        margin-bottom: var(--spacing-sm);
      }

      .nav-menu a {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        padding: var(--spacing-sm) var(--spacing-md);
        color: var(--secondary-text-color);
        text-decoration: none;
        border-radius: var(--border-radius-md);
        transition: all var(--transition-fast);
        font-size: var(--font-size-sm);
      }

      .nav-menu a:hover {
        background: rgba(0, 212, 255, 0.1);
        color: var(--primary-color);
      }

      .content-area {
        padding: var(--spacing-xl);
        overflow-y: auto;
      }

      .welcome-section {
        margin-bottom: var(--spacing-xl);
      }

      .welcome-title {
        font-size: var(--font-size-3xl);
        color: var(--primary-color);
        margin-bottom: var(--spacing-md);
      }

      .modules-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: var(--spacing-lg);
        margin-top: var(--spacing-xl);
      }

      .module-card {
        background: var(--secondary-background-color);
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius-lg);
        padding: var(--spacing-lg);
        transition: all var(--transition-normal);
        cursor: pointer;
      }

      .module-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
        border-color: var(--primary-color);
      }

      .module-icon {
        font-size: 2rem;
        margin-bottom: var(--spacing-md);
      }

      .module-title {
        font-size: var(--font-size-lg);
        font-weight: 600;
        color: var(--text-color);
        margin-bottom: var(--spacing-sm);
      }

      .module-description {
        color: var(--secondary-text-color);
        font-size: var(--font-size-sm);
        line-height: 1.5;
      }

      .client-restricted {
        opacity: 0.5;
        pointer-events: none;
      }

      .access-badge {
        display: inline-block;
        padding: var(--spacing-xs) var(--spacing-sm);
        background: var(--success-color);
        color: white;
        border-radius: var(--border-radius-sm);
        font-size: var(--font-size-xs);
        font-weight: 600;
        margin-bottom: var(--spacing-sm);
      }

      .restricted-badge {
        background: var(--warning-color);
        color: var(--background-color);
      }

      @media (max-width: 768px) {
        .main-content {
          grid-template-columns: 1fr;
        }

        .sidebar {
          display: none;
        }

        .modules-grid {
          grid-template-columns: 1fr;
        }

        .user-type-selector {
          grid-template-columns: 1fr;
        }
        
        .login-card {
          margin: var(--spacing-sm);
        }
        
        .user-type-btn {
          padding: var(--spacing-sm);
          font-size: var(--font-size-sm);
        }
      }
      
      @media (max-width: 480px) {
        .logo-title {
          font-size: var(--font-size-2xl);
        }
        
        .welcome-title {
          font-size: var(--font-size-2xl);
        }
        
        .header-bar {
          padding: var(--spacing-sm);
          flex-direction: column;
          gap: var(--spacing-sm);
        }
        
        .header-info {
          justify-content: center;
        }
      }
    </style>
  </head>
  <body>
    <!-- √Årea de Login -->
    <div id="loginContainer" class="login-container">
      <div class="login-card">
        <div class="logo-container">
          <img
            src="./assets/logo.png"
            alt="AUDITORIA360 Logo"
            onerror="this.style.display='none'"
          />
          <h1 class="logo-title">AUDITORIA360</h1>
          <p class="logo-subtitle">Portal de Gest√£o da Folha</p>
        </div>

        <div class="login-form">
          <h2 class="form-title">Acesso ao Sistema</h2>

          <div class="user-type-selector">
            <button
              type="button"
              class="user-type-btn active"
              data-type="super_admin"
            >
              <div>üëë Super Admin</div>
              <small>Acesso total ao sistema</small>
            </button>
            <button type="button" class="user-type-btn" data-type="contabilidade">
              <div>üè¢ Contabilidade</div>
              <small>Gest√£o de clientes</small>
            </button>
            <button type="button" class="user-type-btn" data-type="cliente_final">
              <div>üë§ Cliente Final</div>
              <small>Consulta empresa</small>
            </button>
          </div>

          <div class="form-group">
            <label for="username" class="form-label">Usu√°rio</label>
            <input
              type="text"
              id="username"
              class="form-input"
              placeholder="Digite seu usu√°rio"
              required
            />
          </div>

          <div class="form-group">
            <label for="password" class="form-label">Senha</label>
            <input
              type="password"
              id="password"
              class="form-input"
              placeholder="Digite sua senha"
              required
            />
          </div>

          <button
            type="button"
            class="button button-primary w-full"
            onclick="handleLogin()"
          >
            üîê Entrar no Sistema
          </button>

          <div class="text-center mt-1">
            <a href="#" class="text-small text-muted">Esqueceu sua senha?</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Dashboard Administrativo -->
    <div id="adminDashboard" class="dashboard-container">
      <header class="header-bar">
        <div class="header-info">
          <img
            src="./assets/logo.png"
            alt="AUDITORIA360"
            class="header-logo"
            onerror="this.style.display='none'"
          />
          <span class="text-lg font-weight-600"
            >AUDITORIA360 - Vis√£o Administrativa</span
          >
        </div>
        <div class="user-info">
          <span class="badge badge-success">üëë Administrador</span>
          <span id="adminUsername">Admin</span>
          <button class="logout-btn" onclick="handleLogout()">Sair</button>
        </div>
      </header>

      <div class="main-content">
        <aside class="sidebar">
          <h3 class="sidebar-title">üìä Navega√ß√£o</h3>
          <ul class="nav-menu">
            <li><a href="#dashboards">üìà Dashboards</a></li>
            <li><a href="#folha">üíº Gest√£o da Folha</a></li>
            <li><a href="#checklist">üìù Checklist</a></li>
            <li><a href="#consultor">ü§ñ Consultor de Riscos</a></li>
            <li><a href="#ccts">üìä Gest√£o de CCTs</a></li>
            <li><a href="#revisao">üîç Revis√£o Cl√°usulas</a></li>
            <li><a href="#obrigacoes">üóìÔ∏è Obriga√ß√µes e Prazos</a></li>
            <li><a href="#parametros">‚öôÔ∏è Par√¢metros Legais</a></li>
            <li><a href="#sugestoes">üí° Sugest√µes CCT</a></li>
            <li><a href="#benchmarking">üìä Benchmarking</a></li>
            <li><a href="#trilha">üîç Trilha de Auditoria</a></li>
            <li><a href="#portal-demandas">üìã Portal de Demandas</a></li>
          </ul>
        </aside>

        <main class="content-area">
          <div class="welcome-section">
            <h1 class="welcome-title">Bem-vindo ao AUDITORIA360</h1>
            <p class="text-muted">
              Sistema integrado de gest√£o e auditoria da folha de pagamento com
              acesso completo a todos os m√≥dulos.
            </p>
          </div>

          <div class="modules-grid">
            <div
              class="module-card"
              onclick="navigateToModule('./dashboards/pages/')"
            >
              <div class="access-badge">‚úÖ Acesso Liberado</div>
              <div class="module-icon">üìà</div>
              <h3 class="module-title">Dashboards</h3>
              <p class="module-description">
                Visualize m√©tricas, indicadores e relat√≥rios detalhados da folha
                de pagamento com dashboards interativos.
              </p>
            </div>

            <div
              class="module-card"
              onclick="navigateToModule('./portal_demandas/')"
            >
              <div class="access-badge">‚úÖ Acesso Liberado</div>
              <div class="module-icon">üìã</div>
              <h3 class="module-title">Portal de Demandas</h3>
              <p class="module-description">
                Gerencie solicita√ß√µes, tickets e demandas dos clientes de forma
                centralizada e eficiente.
              </p>
            </div>

            <div class="module-card">
              <div class="access-badge">‚úÖ Acesso Liberado</div>
              <div class="module-icon">üë•</div>
              <h3 class="module-title">Gerenciamento de Usu√°rios</h3>
              <p class="module-description">
                Controle completo de usu√°rios, permiss√µes e acessos ao sistema.
              </p>
            </div>

            <div class="module-card">
              <div class="access-badge">‚úÖ Acesso Liberado</div>
              <div class="module-icon">ü§ñ</div>
              <h3 class="module-title">Consultor de Riscos</h3>
              <p class="module-description">
                IA avan√ßada para identifica√ß√£o e an√°lise de riscos na folha de
                pagamento.
              </p>
            </div>

            <div class="module-card">
              <div class="access-badge">‚úÖ Acesso Liberado</div>
              <div class="module-icon">‚öôÔ∏è</div>
              <h3 class="module-title">Administra√ß√£o</h3>
              <p class="module-description">
                Configura√ß√µes avan√ßadas, par√¢metros legais e customiza√ß√µes do
                sistema.
              </p>
            </div>

            <div class="module-card">
              <div class="access-badge">‚úÖ Acesso Liberado</div>
              <div class="module-icon">üìä</div>
              <h3 class="module-title">Relat√≥rios Avan√ßados</h3>
              <p class="module-description">
                Relat√≥rios detalhados e personaliz√°veis para an√°lises profundas.
              </p>
            </div>
          </div>
        </main>
      </div>
    </div>

    <!-- Dashboard do Cliente -->
    <div id="clientDashboard" class="dashboard-container">
      <header class="header-bar">
        <div class="header-info">
          <img
            src="./assets/logo.png"
            alt="AUDITORIA360"
            class="header-logo"
            onerror="this.style.display='none'"
          />
          <span class="text-lg font-weight-600"
            >AUDITORIA360 - Portal do Cliente Final</span
          >
        </div>
        <div class="user-info">
          <span class="badge badge-info">üë§ Cliente Final</span>
          <span id="clientUsername">Cliente</span>
          <button class="logout-btn" onclick="handleLogout()">Sair</button>
        </div>
      </header>

      <div class="main-content">
        <aside class="sidebar">
          <h3 class="sidebar-title">üîç Minha Empresa</h3>
          <ul class="nav-menu">
            <li><a href="#meus-dados">üìä Meus Dados</a></li>
            <li><a href="#documentos-empresa">üìÑ Documentos</a></li>
            <li><a href="#relatorios-empresa">üìã Relat√≥rios</a></li>
            <li><a href="#suporte-empresa">üí¨ Suporte</a></li>
          </ul>
        </aside>

        <main class="content-area">
          <div class="welcome-section">
            <h1 class="welcome-title">Portal do Cliente Final</h1>
            <p class="text-muted">
              Acesso exclusivo aos dados da sua empresa com total privacidade e seguran√ßa.
            </p>
          </div>

          <div class="modules-grid">
            <div class="module-card">
              <div class="access-badge">‚úÖ Acesso Liberado</div>
              <div class="module-icon">üìä</div>
              <h3 class="module-title">Dados da Empresa</h3>
              <p class="module-description">
                Visualize informa√ß√µes e m√©tricas exclusivas da sua empresa.
              </p>
            </div>

            <div class="module-card">
              <div class="access-badge">‚úÖ Acesso Liberado</div>
              <div class="module-icon">üìÑ</div>
              <h3 class="module-title">Documentos</h3>
              <p class="module-description">
                Acesse e baixe documentos relacionados √† sua empresa.
              </p>
            </div>

            <div class="module-card">
              <div class="access-badge">‚úÖ Acesso Liberado</div>
              <div class="module-icon">üìã</div>
              <h3 class="module-title">Relat√≥rios</h3>
              <p class="module-description">
                Relat√≥rios personalizados e dados espec√≠ficos da sua empresa.
              </p>
            </div>

            <div class="module-card client-restricted">
              <div class="access-badge restricted-badge">
                üö´ Acesso Restrito
              </div>
              <div class="module-icon">üë•</div>
              <h3 class="module-title">Outras Empresas</h3>
              <p class="module-description">
                Acesso restrito - apenas dados da sua empresa s√£o vis√≠veis.
              </p>
            </div>

            <div class="module-card client-restricted">
              <div class="access-badge restricted-badge">
                üö´ Acesso Restrito
              </div>
              <div class="module-icon">‚öôÔ∏è</div>
              <h3 class="module-title">Administra√ß√£o</h3>
              <p class="module-description">
                Funcionalidade dispon√≠vel apenas para administradores.
              </p>
            </div>

            <div class="module-card">
              <div class="access-badge">‚úÖ Acesso Liberado</div>
              <div class="module-icon">üí¨</div>
              <h3 class="module-title">Suporte Especializado</h3>
              <p class="module-description">
                Suporte dedicado para quest√µes espec√≠ficas da sua empresa.
              </p>
            </div>
          </div>
        </main>
      </div>
    </div>

    <!-- Dashboard da Contabilidade -->
    <div id="contabilidadeDashboard" class="dashboard-container">
      <header class="header-bar">
        <div class="header-info">
          <img
            src="./assets/logo.png"
            alt="AUDITORIA360"
            class="header-logo"
            onerror="this.style.display='none'"
          />
          <span class="text-lg font-weight-600"
            >AUDITORIA360 - Portal da Contabilidade</span
          >
        </div>
        <div class="user-info">
          <span class="badge badge-warning">üè¢ Contabilidade</span>
          <span id="contabilidadeUsername">Gestor</span>
          <button class="logout-btn" onclick="handleLogout()">Sair</button>
        </div>
      </header>

      <div class="main-content">
        <aside class="sidebar">
          <h3 class="sidebar-title">üè¢ Gest√£o</h3>
          <ul class="nav-menu">
            <li><a href="#meus-clientes">üë• Meus Clientes</a></li>
            <li><a href="#folha-clientes">üíº Folha dos Clientes</a></li>
            <li><a href="#relatorios-gestao">üìä Relat√≥rios de Gest√£o</a></li>
            <li><a href="#documentos-gestao">üìÑ Documentos</a></li>
            <li><a href="#checklist-gestao">üìù Checklist</a></li>
            <li><a href="#consultor-gestao">ü§ñ Consultor</a></li>
            <li><a href="#suporte-gestao">üí¨ Suporte</a></li>
          </ul>
        </aside>

        <main class="content-area">
          <div class="welcome-section">
            <h1 class="welcome-title">Portal da Contabilidade</h1>
            <p class="text-muted">
              Gerencie seus clientes e acesse dados restritos ao seu escopo de contabilidade.
            </p>
          </div>

          <div class="modules-grid">
            <div class="module-card">
              <div class="access-badge">‚úÖ Acesso Liberado</div>
              <div class="module-icon">üë•</div>
              <h3 class="module-title">Meus Clientes</h3>
              <p class="module-description">
                Visualize e gerencie apenas os clientes da sua contabilidade.
              </p>
            </div>

            <div class="module-card">
              <div class="access-badge">‚úÖ Acesso Liberado</div>
              <div class="module-icon">üíº</div>
              <h3 class="module-title">Gest√£o da Folha</h3>
              <p class="module-description">
                Processe e audite a folha de pagamento dos seus clientes.
              </p>
            </div>

            <div class="module-card">
              <div class="access-badge">‚úÖ Acesso Liberado</div>
              <div class="module-icon">üìä</div>
              <h3 class="module-title">Relat√≥rios Segmentados</h3>
              <p class="module-description">
                Relat√≥rios restritos aos dados da sua carteira de clientes.
              </p>
            </div>

            <div class="module-card">
              <div class="access-badge">‚úÖ Acesso Liberado</div>
              <div class="module-icon">ü§ñ</div>
              <h3 class="module-title">Consultor de Riscos</h3>
              <p class="module-description">
                IA para an√°lise de riscos espec√≠ficos dos seus clientes.
              </p>
            </div>

            <div class="module-card client-restricted">
              <div class="access-badge restricted-badge">
                üö´ Acesso Restrito
              </div>
              <div class="module-icon">üåê</div>
              <h3 class="module-title">Outras Contabilidades</h3>
              <p class="module-description">
                Acesso restrito - dados de outras contabilidades s√£o protegidos.
              </p>
            </div>

            <div class="module-card client-restricted">
              <div class="access-badge restricted-badge">
                üö´ Acesso Restrito
              </div>
              <div class="module-icon">‚öôÔ∏è</div>
              <h3 class="module-title">Administra√ß√£o Global</h3>
              <p class="module-description">
                Configura√ß√µes globais dispon√≠veis apenas para super admin.
              </p>
            </div>
          </div>
        </main>
      </div>
    </div>

    <script>
      // Vari√°veis globais
      let currentUserType = "super_admin";
      let isLoggedIn = false;

      // Credenciais de teste conforme especifica√ß√£o
      const testCredentials = {
        // Super Admin
        "admin@auditoria360.com": {
          password: "senha_admin",
          userType: "super_admin",
          name: "Super Administrator",
          scope: "all"
        },
        // Contabilidade A - Gestor
        "gestor@contabilidade-a.com": {
          password: "senha_gestor_a", 
          userType: "contabilidade",
          name: "Gestor Contabilidade A",
          scope: "CONTAB_A"
        },
        // Cliente da Contabilidade A
        "contato@empresa-x.com": {
          password: "senha_cliente_x",
          userType: "cliente_final", 
          name: "Cliente Empresa X",
          scope: "EMPRESA_X"
        },
        // Contabilidade B - Gestor
        "gestor@contabilidade-b.com": {
          password: "senha_gestor_b",
          userType: "contabilidade",
          name: "Gestor Contabilidade B", 
          scope: "CONTAB_B"
        },
        // Legacy credentials for compatibility
        "admin": {
          password: "admin123",
          userType: "super_admin",
          name: "Administrator",
          scope: "all"
        },
        "contabilidade": {
          password: "conta123",
          userType: "contabilidade",
          name: "Contabilidade User",
          scope: "DEFAULT_CONTAB"
        }
      };

      // Inicializa√ß√£o
      document.addEventListener("DOMContentLoaded", function () {
        initializeApp();
        setupEventListeners();
      });

      function initializeApp() {
        // Verifica se h√° sess√£o salva
        const savedSession = localStorage.getItem("auditoria360_session");
        if (savedSession) {
          const session = JSON.parse(savedSession);
          if (session.userType && session.username && session.userData) {
            // Check if session is still valid (24 hours)
            const sessionAge = Date.now() - session.timestamp;
            if (sessionAge < 24 * 60 * 60 * 1000) {
              loginUser(session.userType, session.username, session.userData);
            } else {
              // Session expired, clear it
              localStorage.removeItem("auditoria360_session");
              showNotification("Sess√£o expirada. Fa√ßa login novamente.", "warning");
            }
          }
        }
      }

      function setupEventListeners() {
        // Seletores de tipo de usu√°rio
        const userTypeButtons = document.querySelectorAll(".user-type-btn");
        userTypeButtons.forEach(btn => {
          btn.addEventListener("click", function () {
            userTypeButtons.forEach(b => b.classList.remove("active"));
            this.classList.add("active");
            currentUserType = this.dataset.type;
          });
        });

        // Enter no formul√°rio
        document.addEventListener("keypress", function (e) {
          if (e.key === "Enter" && !isLoggedIn) {
            handleLogin();
          }
        });
      }

      function handleLogin() {
        const username = document.getElementById("username").value.trim();
        const password = document.getElementById("password").value.trim();

        if (!username || !password) {
          showNotification("Por favor, preencha todos os campos.", "warning");
          return;
        }

        // Enhanced authentication with user data
        const userData = authenticateUser(username, password);
        if (userData) {
          // Use the actual user type from authentication, not the UI selection
          const actualUserType = userData.userType;
          loginUser(actualUserType, username, userData);
          saveSession(actualUserType, username, userData);
          showNotification(`Login realizado com sucesso! Bem-vindo(a), ${userData.name}`, "success");
          
          // Log for debugging
          console.log(`Authenticated as: ${userData.name} (${actualUserType}) - Scope: ${userData.scope}`);
        } else {
          showNotification("Credenciais inv√°lidas. Verifique usu√°rio e senha.", "danger");
          console.log("Authentication failed for:", username);
        }
      }

      function authenticateUser(username, password) {
        // Enhanced authentication with test credentials
        const user = testCredentials[username];
        if (user && user.password === password) {
          return {
            username: username,
            name: user.name,
            userType: user.userType,
            scope: user.scope,
            authenticated: true
          };
        }
        return null;
      }

      function loginUser(userType, username, userData = null) {
        try {
          isLoggedIn = true;
          currentUserType = userType;

          // Log successful login
          window.navigationLogger?.logRouteChange('/login', '/dashboard', {
            userType: userType,
            username: username,
            loginMethod: 'credentials',
            success: true
          });

          // Esconder login
          document.getElementById("loginContainer").style.display = "none";

          // Esconder todos os dashboards primeiro
          document.getElementById("adminDashboard").classList.remove("active");
          document.getElementById("clientDashboard").classList.remove("active");
          document.getElementById("contabilidadeDashboard").classList.remove("active");

          // Mostrar dashboard apropriado baseado no tipo de usu√°rio
          if (userType === "super_admin") {
            document.getElementById("adminDashboard").classList.add("active");
            document.getElementById("adminUsername").textContent = userData?.name || username;
          } else if (userType === "contabilidade") {
            document.getElementById("contabilidadeDashboard").classList.add("active");
            document.getElementById("contabilidadeUsername").textContent = userData?.name || username;
          } else if (userType === "cliente_final") {
            document.getElementById("clientDashboard").classList.add("active");
            document.getElementById("clientUsername").textContent = userData?.name || username;
          }

          // Anima√ß√£o de entrada
          setTimeout(() => {
            document.querySelector(".dashboard-container.active").style.opacity = "1";
          }, 100);
        } catch (error) {
          window.navigationLogger?.logNavigationError(error, '/dashboard', 'login', {
            userType: userType,
            username: username,
            step: 'dashboard_display'
          });
          
          console.error('Error in loginUser:', error);
          showNotification("Erro ao carregar dashboard", "danger");
        }
      }

      function handleLogout() {
        if (confirm("Tem certeza que deseja sair?")) {
          isLoggedIn = false;

          // Limpar sess√£o
          localStorage.removeItem("auditoria360_session");

          // Esconder todos os dashboards
          document.getElementById("adminDashboard").classList.remove("active");
          document.getElementById("clientDashboard").classList.remove("active");
          document.getElementById("contabilidadeDashboard").classList.remove("active");

          // Mostrar login
          document.getElementById("loginContainer").style.display = "flex";

          // Limpar campos
          document.getElementById("username").value = "";
          document.getElementById("password").value = "";
          
          // Reset user type selector to default
          document.querySelectorAll(".user-type-btn").forEach(btn => btn.classList.remove("active"));
          document.querySelector("[data-type='super_admin']").classList.add("active");
          currentUserType = "super_admin";

          showNotification("Logout realizado com sucesso!", "info");
        }
      }

      function saveSession(userType, username, userData) {
        const session = {
          userType: userType,
          username: username,
          userData: userData,
          timestamp: Date.now(),
        };
        localStorage.setItem("auditoria360_session", JSON.stringify(session));
      }

      function navigateToModule(path) {
        if (isLoggedIn) {
          try {
            // Log navigation attempt
            window.navigationLogger?.logNavigationSuccess(path, 'navigate', {
              trigger: 'module_click',
              userType: currentUserType,
              authenticated: true
            });
            
            // Em produ√ß√£o, navegar para o m√≥dulo espec√≠fico
            console.log(`Navegando para: ${path}`);
            showNotification(`Redirecionando para ${path}...`, "info");

            // Redirecionamento real para o m√≥dulo
            setTimeout(() => {
              window.location.href = path;
              console.log(`Navegando para m√≥dulo ${path}`);
              
              // Log successful load
              window.navigationLogger?.logNavigationSuccess(path, 'load', {
                loadTime: 1000,
                success: true
              });
            }, 1000);
          } catch (error) {
            // Log navigation error
            window.navigationLogger?.logNavigationError(error, path, 'navigate', {
              trigger: 'module_click',
              userType: currentUserType,
              authenticated: isLoggedIn
            });
            
            showNotification(`Erro ao navegar para ${path}`, "danger");
            console.error('Navigation error:', error);
          }
        } else {
          window.navigationLogger?.logNavigationError(
            new Error('Unauthorized navigation attempt'),
            path,
            'navigate',
            {
              trigger: 'module_click',
              userType: currentUserType,
              authenticated: false
            }
          );
          
          showNotification("Fa√ßa login para acessar este m√≥dulo.", "warning");
        }
      }

      function showNotification(message, type = "info") {
        // Criar elemento de notifica√ß√£o
        const notification = document.createElement("div");
        notification.className = `alert alert-${type} animate-fade-in`;
        notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 9999;
                max-width: 400px;
                opacity: 0;
                transform: translateX(100%);
                transition: all 0.3s ease;
            `;
        notification.textContent = message;

        document.body.appendChild(notification);

        // Animar entrada
        setTimeout(() => {
          notification.style.opacity = "1";
          notification.style.transform = "translateX(0)";
        }, 100);

        // Remover ap√≥s 4 segundos
        setTimeout(() => {
          notification.style.opacity = "0";
          notification.style.transform = "translateX(100%)";
          setTimeout(() => {
            if (notification.parentNode) {
              notification.parentNode.removeChild(notification);
            }
          }, 300);
        }, 4000);
      }

      // Fun√ß√£o para demonstrar interatividade dos cards
      document.addEventListener("click", function (e) {
        if (
          e.target.closest(".module-card") &&
          !e.target.closest(".client-restricted")
        ) {
          const card = e.target.closest(".module-card");
          const title = card.querySelector(".module-title").textContent;

          // Efeito visual no clique
          card.style.transform = "scale(0.98)";
          setTimeout(() => {
            card.style.transform = "";
          }, 150);

          showNotification(`Acessando m√≥dulo: ${title}`, "info");
        }
      });
    </script>
  </body>
</html>
